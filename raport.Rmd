---
title: "Raport"
author: "Maria Kałuska, Marcelina Kurek"
date: "14 05 2020"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(data.table)
library(readr)
library(ggplot2)
```
```{r, include=FALSE}
busyStations <- data.table(read_csv("busy_stations.csv"))
endStations <- data.table(read_csv("end_stations.csv"))
Routes <- data.table(read_csv("routes_to_plot.csv"))
```
Najbardziej oblegane stacje w Nowym Yorku
```{r, include=TRUE, cache=TRUE}
ggplot(busyStations, aes(x=longitude, y=latitude, color=N)) + 
  geom_point(alpha=0.2) +
  scale_size(range=c(.1, 10)) +
  scale_color_gradient(low="blue", high="red")
```
Najczęstsze stacje docelowe
```{r, include=TRUE, cache=TRUE}
ggplot(endStations, aes(x=longitude, y=latitude, color=N)) + 
  geom_point(alpha=0.4) +
  scale_size(range=c(.1, 10)) +
  scale_color_gradient(low="blue", high="red")
```
100 najbardziej uczęszczanych tras
```{r, include=TRUE}
ggplot(Routes, aes(x=`start longitude`, y=`start latitude`, group=id)) +
  geom_point(size=2, color="blue") +
  geom_line(color="red")
```

```{r, include=TRUE}
ggplot(data=dane_do_wykresu, aes(x=`rok urodzenia`, y=`liczba osób`, fill = as.factor(gender))) +
  geom_bar(stat="identity")+
  geom_text(aes(y=0, label=10), vjust=1.6, 
            color="white", size=3.5)+
  scale_fill_brewer(palette = "Dark2", name = "Płeć", labels = c("Brak danych", "Mężczyzna", "Kobieta") )+
  ggtitle("Użytkownicy rowerów miejskich, którzy wypożyczają rowery na najdłuższy okres czasu")
```
